# Generate train/valid splits
python examples/wav2vec/wav2vec_manifest.py /home/dxng/datasets/LibriSpeech/train-clean-100 --dest manifest/train --ext flac
# k-means training
python train.py manifest/train --save-dir model/kmeans-test --num-workers 4 --fp16 --max-update 40 --save-interval 1 --no-epoch-checkpoints --arch wav2vec --task audio_pretraining --min-lr 1e-06 --stop-min-lr 1e-09 --optimizer adam --lr 1e-05 --lr-scheduler cosine --activation gelu --offset auto --skip-connections-agg --residual-scale 0.5 --vq-type kmeans --loss-weights [1] --vq-groups 2 --vq-depth 2 --combine-groups --vq-vars 320 --vq-temp "(2,0.5,0.999995)" --prediction-steps 12 --warmup-updates 1000 --warmup-init-lr 1e-07 --criterion wav2vec --num-negatives 10 --max-sample-size 150000 --max-tokens 3000 --cross-sample-negatives 0 --update-freq 1 --seed 0 --skip-invalid-size-inputs-valid-test --conv-feature-layers "[(512, 10, 5), (512, 8, 4), (512, 4, 2), (512, 4, 2), (512, 4, 2), (512, 1, 1), (512, 1, 1), (512, 1, 1)]" --conv-aggregator-layers "[(512, 2, 1), (512, 3, 1), (512, 4, 1), (512, 5, 1), (512, 6, 1), (512, 7, 1), (512, 8, 1), (512, 9, 1), (512, 10, 1), (512, 11, 1), (512, 12, 1), (512, 13, 1)]" --log-keys [\"prob_perplexity\",\"code_perplexity\",\"temp\"]
CUDA_VISIBLE_DEVICES=0 fairseq-train manifest/train --save-dir model/kmeans-test --num-workers 4 --fp16 --max-update 40 --save-interval 1 --no-epoch-checkpoints --arch wav2vec --task audio_pretraining --min-lr 0 --optimizer adam --lr 1e-05 --lr-scheduler cosine --activation gelu --offset auto --skip-connections-agg --residual-scale 0.5 --vq-type kmeans --loss-weights [1] --vq-groups 2 --vq-depth 2 --combine-groups --vq-vars 320 --vq-temp "(2,0.5,0.999995)" --prediction-steps 12 --warmup-updates 1000 --warmup-init-lr 1e-07 --criterion wav2vec --num-negatives 10 --max-sample-size 150000 --max-tokens 300000 --cross-sample-negatives 0 --update-freq 1 --seed 0 --skip-invalid-size-inputs-valid-test --conv-feature-layers "[(512, 10, 5), (512, 8, 4), (512, 4, 2), (512, 4, 2), (512, 4, 2), (512, 1, 1), (512, 1, 1), (512, 1, 1)]" --conv-aggregator-layers "[(512, 2, 1), (512, 3, 1), (512, 4, 1), (512, 5, 1), (512, 6, 1), (512, 7, 1), (512, 8, 1), (512, 9, 1), (512, 10, 1), (512, 11, 1), (512, 12, 1), (512, 13, 1)]" --log-keys [\"prob_perplexity\",\"code_perplexity\",\"temp\"]